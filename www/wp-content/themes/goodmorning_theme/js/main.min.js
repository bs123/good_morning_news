function setLoading(a){loadingState=a,a?$("body").addClass("loading"):$("body").removeClass("loading")}function isLoading(){return loadingState}function set_read(a){$.ajax({url:WP_API_Settings.root+"goodmorning-news/1.0/read/"+a,method:"GET",beforeSend:function(a){a.setRequestHeader("X-WP-Nonce",WP_API_Settings.nonce)}}).done(function(a){console.log("read successful")}).error(function(a){})}function insert_posts(a){if("object"==typeof a){for(var b in a){var c=a[b];console.log(c),duration+=c.consume_dur;var d=$("<li>").attr("id","post-"+b).addClass("article card").attr("postid",c.id).attr("duration",c.consume_dur);$subheadline=$("<span>").addClass("small").html(c.headline),$headline=$("<h1>").html(c.title).prepend($subheadline),$header=$("<header>").addClass("article-header").append($headline),""!=c.thumbnail&&null!=c.thumbnail&&$header.css("background-image","url("+c.thumbnail+")"),$video=null,null!=c.video.video_src&&($src=$("<source>").attr("src",c.video.video_src).attr("type","video/mp4"),$video=$("<video>").append($src).attr("controls",!0).addClass("video-js"),$header.append($video),d.addClass("video")),d.append($header),$downvote_link=$("<a>").attr("href","#downvote").addClass("downvote fa fa-thumbs-o-down").attr("id","b_rate_down"),$upvote_link=$("<a>").attr("href","#upvote").addClass("upvote fa fa-thumbs-o-up").attr("id","b_rate_up"),$more_link=$("<a>").attr("href","#upvote").addClass("more_content fa fa-angle-down"),$buttons=$("<div>").addClass("buttons").append($downvote_link).append($more_link).append($upvote_link),d.append($buttons);var e=$("<div>").addClass("datetime").html(c.date),f=$("<div>").addClass("content clearfix").html(c.content).prepend(e);if(d.append(f),$("#master-list").append(d),duration>=600)break}console.log("duration : "+duration)}var g=$("li.card.goodbye-card");g.remove(),$("ul.cards").append(g)}!function(){for(var a,b=function(){},c=["assert","clear","count","debug","dir","dirxml","error","exception","group","groupCollapsed","groupEnd","info","log","markTimeline","profile","profileEnd","table","time","timeEnd","timeStamp","trace","warn"],d=c.length,e=window.console=window.console||{};d--;)a=c[d],e[a]||(e[a]=b)}();var duration=0,loadingState=!1;$(document).ready(function(){setLoading(!0),$.ajax({url:WP_API_Settings.root+"goodmorning-news/1.0/list-news/",method:"GET",beforeSend:function(a){a.setRequestHeader("X-WP-Nonce",WP_API_Settings.nonce)}}).done(function(a){insert_posts(a),setLoading(!1)}).error(function(a){setLoading(!1)}),$("ul.cards").on("click","li.card a.upvote",function(a){var b=$(a.currentTarget).parents("li.card"),c=b.attr("postid");setLoading(!0),$.ajax({url:WP_API_Settings.root+"goodmorning-news/1.0/upvote/"+c,method:"GET",beforeSend:function(a){a.setRequestHeader("X-WP-Nonce",WP_API_Settings.nonce)}}).done(function(a){console.log("upvote successful"),b.addClass("upvoted").removeClass("downvoted"),setLoading(!1)}).error(function(a){setLoading(!1)})}),$("ul.cards").on("click","li.card a.downvote",function(a){var b=$(a.currentTarget).parents("li.card"),c=b.attr("postid");set_read(b.attr("postid")),setLoading(!0),$.ajax({url:WP_API_Settings.root+"goodmorning-news/1.0/downvote/"+c,method:"GET",beforeSend:function(a){a.setRequestHeader("X-WP-Nonce",WP_API_Settings.nonce)}}).done(function(a){console.log("downvote successful"),b.addClass("downvoted").removeClass("upvoted"),setLoading(!1)}).error(function(a){setLoading(!1)})}),$("ul.cards").on("click","li.card a.more_content",function(a){var b=$(a.currentTarget).parents("li.card");b.toggleClass("content_open"),set_read(b.attr("postid")),b.hasClass("content_open")&&$("video",b).length>0?$("video",b).each(function(){$(this).get(0).play()}):$("video",b).length>0&&$("video",b).each(function(){$(this).get(0).pause()})}),$("#b_next").click(function(){if(!isLoading()){var a=$("ul.cards li.card.show"),b=a.next("li.card");if(b.length>0){a.removeClass("show").removeClass("content_open"),b.addClass("show"),$("video").each(function(){$(this).get(0).pause()});var c=0;b.prevAll("li.card").each(function(){c+=parseInt($(this).attr("duration"))||0}),$(".progress-bar").css("width",c/duration*100+"%")}}}),$("#b_prev").click(function(){if(!isLoading()){var a=$("ul.cards li.card.show"),b=a.prev("li.card");if(b.length>0){a.removeClass("show").removeClass("content_open"),b.addClass("show"),$("video").each(function(){$(this).get(0).pause()});var c=0;b.prevAll("li.card").each(function(){c+=parseInt($(this).attr("duration"))||0}),$(".progress-bar").css("width",c/duration*100+"%")}}})});